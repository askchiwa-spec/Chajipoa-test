<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHAJIPOA Enhanced Dashboard Preview</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4285f4;
            --secondary: #34a853;
            --danger: #ea4335;
            --warning: #fbbc04;
            --dark: #202124;
            --light: #f8f9fa;
            --gray: #5f6368;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
        }

        .logo-text {
            font-size: 28px;
            font-weight: 700;
            color: var(--dark);
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 16px;
            border-radius: 20px;
            background: var(--secondary);
            color: white;
            font-weight: 500;
        }

        .connection-status.disconnected {
            background: var(--danger);
        }

        .connection-status.connecting {
            background: var(--warning);
            color: var(--dark);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(66, 133, 244, 0.2);
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .metric-value {
            font-size: 36px;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }

        .metric-label {
            font-size: 14px;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .trend {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }

        .trend.positive {
            background: rgba(52, 168, 83, 0.2);
            color: var(--secondary);
        }

        .trend.negative {
            background: rgba(234, 67, 53, 0.2);
            color: var(--danger);
        }

        .chart-container {
            height: 200px;
            position: relative;
            margin: 20px 0;
        }

        .chart-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #f0f2f5, #e8eaed);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            font-weight: 500;
        }

        .table-container {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            background: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        .data-table tr:hover {
            background: rgba(66, 133, 244, 0.05);
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: rgba(52, 168, 83, 0.2);
            color: var(--secondary);
        }

        .status-pending {
            background: rgba(251, 188, 4, 0.2);
            color: var(--warning);
        }

        .status-inactive {
            background: rgba(234, 67, 53, 0.2);
            color: var(--danger);
        }

        .controls {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .control-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-success {
            background: var(--secondary);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .export-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--secondary);
        }

        .notification.warning {
            background: var(--warning);
            color: var(--dark);
        }

        .notification.error {
            background: var(--danger);
        }

        .websocket-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--danger);
            animation: pulse 1.5s infinite;
        }

        .websocket-indicator.connected {
            background: var(--secondary);
            animation: none;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.4; }
            100% { opacity: 1; }
        }

        .realtime-update {
            animation: highlight 2s ease;
        }

        @keyframes highlight {
            0% { background: rgba(66, 133, 244, 0.3); }
            100% { background: transparent; }
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .control-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <div class="logo-icon">C</div>
                <div class="logo-text">CHAJIPOA DASHBOARD</div>
            </div>
            <div class="connection-status" id="connection-status">
                <div class="websocket-indicator" id="ws-indicator"></div>
                <span id="status-text">CONNECTING...</span>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <div class="control-group">
                <button class="btn btn-primary" onclick="simulateRealtimeData()">
                    <i class="fas fa-sync-alt"></i> Simulate Real-time Updates
                </button>
                <button class="btn btn-success" onclick="exportDashboard('pdf')">
                    <i class="fas fa-file-pdf"></i> Export PDF
                </button>
                <button class="btn btn-warning" onclick="exportDashboard('excel')">
                    <i class="fas fa-file-excel"></i> Export Excel
                </button>
                <button class="btn btn-danger" onclick="toggleWebSocket()">
                    <i class="fas fa-plug"></i> <span id="ws-toggle-text">Disconnect</span>
                </button>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Overview Metrics -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-chart-line"></i>
                        Overview Metrics
                    </div>
                    <div class="trend positive">
                        <i class="fas fa-arrow-up"></i>
                        +12.5%
                    </div>
                </div>
                <div class="metric-value" id="total-revenue">TZS 15,420</div>
                <div class="metric-label">Total Revenue Today</div>
                <div class="chart-container">
                    <div class="chart-placeholder">
                        <i class="fas fa-chart-bar fa-2x"></i>
                        <span style="margin-left: 10px;">Revenue Trend Chart</span>
                    </div>
                </div>
            </div>

            <!-- Active Users -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-users"></i>
                        Active Users
                    </div>
                    <div class="trend positive">
                        <i class="fas fa-arrow-up"></i>
                        +8.2%
                    </div>
                </div>
                <div class="metric-value" id="active-users">1,247</div>
                <div class="metric-label">Currently Online</div>
                <div class="chart-container">
                    <div class="chart-placeholder">
                        <i class="fas fa-user-clock fa-2x"></i>
                        <span style="margin-left: 10px;">User Activity Chart</span>
                    </div>
                </div>
            </div>

            <!-- Device Utilization -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-battery-full"></i>
                        Device Utilization
                    </div>
                    <div class="trend positive">
                        <i class="fas fa-arrow-up"></i>
                        +5.7%
                    </div>
                </div>
                <div class="metric-value" id="device-utilization">87.5%</div>
                <div class="metric-label">Current Utilization Rate</div>
                <div class="chart-container">
                    <div class="chart-placeholder">
                        <i class="fas fa-percentage fa-2x"></i>
                        <span style="margin-left: 10px;">Utilization Chart</span>
                    </div>
                </div>
            </div>

            <!-- Recent Transactions -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-exchange-alt"></i>
                        Recent Transactions
                    </div>
                    <div class="trend positive">
                        <i class="fas fa-arrow-up"></i>
                        +15.3%
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table" id="transactions-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>User</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>#TXN001</td>
                                <td>John M.</td>
                                <td>TZS 2,500</td>
                                <td><span class="status-badge status-active">Completed</span></td>
                                <td>2 min ago</td>
                            </tr>
                            <tr>
                                <td>#TXN002</td>
                                <td>Sarah K.</td>
                                <td>TZS 3,200</td>
                                <td><span class="status-badge status-pending">Pending</span></td>
                                <td>5 min ago</td>
                            </tr>
                            <tr>
                                <td>#TXN003</td>
                                <td>Mike R.</td>
                                <td>TZS 1,800</td>
                                <td><span class="status-badge status-active">Completed</span></td>
                                <td>8 min ago</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Device Status -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-microchip"></i>
                        Device Status
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Device ID</th>
                                <th>Location</th>
                                <th>Battery</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>DEV001</td>
                                <td>Downtown</td>
                                <td>85%</td>
                                <td><span class="status-badge status-active">Online</span></td>
                            </tr>
                            <tr>
                                <td>DEV002</td>
                                <td>Airport</td>
                                <td>42%</td>
                                <td><span class="status-badge status-warning">Low Battery</span></td>
                            </tr>
                            <tr>
                                <td>DEV003</td>
                                <td>Mall</td>
                                <td>95%</td>
                                <td><span class="status-badge status-active">Online</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Station Performance -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-map-marker-alt"></i>
                        Station Performance
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Station</th>
                                <th>Utilization</th>
                                <th>Revenue</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Central Plaza</td>
                                <td>92%</td>
                                <td>TZS 4,200</td>
                                <td><span class="status-badge status-active">Active</span></td>
                            </tr>
                            <tr>
                                <td>University</td>
                                <td>78%</td>
                                <td>TZS 3,800</td>
                                <td><span class="status-badge status-active">Active</span></td>
                            </tr>
                            <tr>
                                <td>Shopping Mall</td>
                                <td>65%</td>
                                <td>TZS 2,900</td>
                                <td><span class="status-badge status-pending">Maintenance</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notifications"></div>

    <script>
        // Dashboard Simulation Class
        class CHAJIPOADashboardSimulator {
            constructor() {
                this.isConnected = false;
                this.simulationInterval = null;
                this.updateCounter = 0;
                this.initWebSocketSimulation();
                this.bindEvents();
            }

            initWebSocketSimulation() {
                // Simulate WebSocket connection
                setTimeout(() => {
                    this.connectWebSocket();
                }, 1000);
            }

            connectWebSocket() {
                this.isConnected = true;
                this.updateConnectionStatus('CONNECTED', 'connected');
                this.showNotification('WebSocket connection established!', 'success');
                
                // Simulate real-time data updates
                this.startSimulation();
            }

            disconnectWebSocket() {
                this.isConnected = false;
                this.updateConnectionStatus('DISCONNECTED', 'disconnected');
                this.showNotification('WebSocket disconnected', 'warning');
                
                if (this.simulationInterval) {
                    clearInterval(this.simulationInterval);
                    this.simulationInterval = null;
                }
            }

            toggleWebSocket() {
                if (this.isConnected) {
                    this.disconnectWebSocket();
                } else {
                    this.connectWebSocket();
                }
            }

            updateConnectionStatus(text, indicatorClass) {
                document.getElementById('status-text').textContent = text;
                document.getElementById('ws-indicator').className = `websocket-indicator ${indicatorClass}`;
                document.getElementById('ws-toggle-text').textContent = this.isConnected ? 'Disconnect' : 'Connect';
            }

            startSimulation() {
                this.simulationInterval = setInterval(() => {
                    this.simulateRealtimeUpdate();
                }, 3000); // Update every 3 seconds
            }

            simulateRealtimeUpdate() {
                this.updateCounter++;
                
                // Random updates to simulate real data
                const updates = [
                    () => this.updateMetric('total-revenue', Math.floor(Math.random() * 20000) + 10000),
                    () => this.updateMetric('active-users', Math.floor(Math.random() * 2000) + 800),
                    () => this.updateMetric('device-utilization', (Math.random() * 30 + 70).toFixed(1)),
                    () => this.addTransactionRow(),
                    () => this.updateDeviceStatus()
                ];

                // Execute random update
                const randomUpdate = updates[Math.floor(Math.random() * updates.length)];
                randomUpdate();
                
                // Add notification for major updates
                if (this.updateCounter % 5 === 0) {
                    this.showNotification(`Real-time update #${this.updateCounter} processed`, 'success');
                }
            }

            updateMetric(elementId, newValue) {
                const element = document.getElementById(elementId);
                if (element) {
                    element.textContent = typeof newValue === 'number' && elementId !== 'device-utilization' 
                        ? `TZS ${newValue.toLocaleString()}` 
                        : elementId === 'device-utilization' 
                            ? `${newValue}%`
                            : newValue;
                    element.parentElement.classList.add('realtime-update');
                    setTimeout(() => {
                        element.parentElement.classList.remove('realtime-update');
                    }, 2000);
                }
            }

            addTransactionRow() {
                const table = document.getElementById('transactions-table');
                const tbody = table.querySelector('tbody');
                
                // Create new row
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td>#TXN${String(Date.now()).slice(-3)}</td>
                    <td>User ${Math.floor(Math.random() * 100)}</td>
                    <td>TZS ${Math.floor(Math.random() * 5000) + 1000}</td>
                    <td><span class="status-badge ${Math.random() > 0.8 ? 'status-pending' : 'status-active'}">
                        ${Math.random() > 0.8 ? 'Pending' : 'Completed'}
                    </span></td>
                    <td>Just now</td>
                `;
                
                // Add animation class
                newRow.style.opacity = '0';
                newRow.style.transform = 'translateX(20px)';
                
                // Insert at the beginning
                tbody.insertBefore(newRow, tbody.firstChild);
                
                // Animate in
                setTimeout(() => {
                    newRow.style.transition = 'all 0.3s ease';
                    newRow.style.opacity = '1';
                    newRow.style.transform = 'translateX(0)';
                }, 10);
                
                // Remove oldest row if too many
                if (tbody.children.length > 10) {
                    tbody.removeChild(tbody.lastChild);
                }
            }

            updateDeviceStatus() {
                const rows = document.querySelectorAll('#device-status-table tbody tr');
                if (rows.length > 0) {
                    const randomRow = rows[Math.floor(Math.random() * rows.length)];
                    const batteryCell = randomRow.cells[2];
                    const statusCell = randomRow.cells[3];
                    
                    // Update battery level
                    const newBattery = Math.floor(Math.random() * 100);
                    batteryCell.textContent = `${newBattery}%`;
                    
                    // Update status based on battery
                    const statusBadge = statusCell.querySelector('.status-badge');
                    if (newBattery > 80) {
                        statusBadge.className = 'status-badge status-active';
                        statusBadge.textContent = 'Online';
                    } else if (newBattery > 20) {
                        statusBadge.className = 'status-badge status-warning';
                        statusBadge.textContent = 'Low Battery';
                    } else {
                        statusBadge.className = 'status-badge status-danger';
                        statusBadge.textContent = 'Critical';
                    }
                }
            }

            bindEvents() {
                // Make cards clickable for detailed views
                document.querySelectorAll('.card').forEach(card => {
                    card.addEventListener('click', () => {
                        this.showDetailedView(card);
                    });
                });
            }

            showDetailedView(card) {
                const title = card.querySelector('.card-title').textContent;
                this.showNotification(`Opening detailed view for: ${title}`, 'success');
                // In a real implementation, this would open a modal or navigate to detailed page
            }

            showNotification(message, type = 'success') {
                const notification = document.createElement('div');
                notification.className = `notification ${type} show`;
                notification.innerHTML = `
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-times-circle'}"></i>
                    ${message}
                `;
                
                document.getElementById('notifications').appendChild(notification);
                
                // Auto-remove after 3 seconds
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => {
                        notification.remove();
                    }, 300);
                }, 3000);
            }
        }

        // Export Functions
        function exportDashboard(format) {
            const simulator = window.dashboardSimulator;
            simulator.showNotification(`Exporting dashboard as ${format.toUpperCase()}...`, 'success');
            
            // Simulate export process
            setTimeout(() => {
                const exportData = {
                    format: format,
                    timestamp: new Date().toISOString(),
                    metrics: {
                        totalRevenue: document.getElementById('total-revenue').textContent,
                        activeUsers: document.getElementById('active-users').textContent,
                        deviceUtilization: document.getElementById('device-utilization').textContent
                    }
                };
                
                // In real implementation, this would generate actual files
                simulator.showNotification(`${format.toUpperCase()} export completed!`, 'success');
                
                // Simulate file download
                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `chajipoa-dashboard-${format}-${Date.now()}.${format === 'excel' ? 'xlsx' : format}`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 1500);
        }

        function toggleWebSocket() {
            window.dashboardSimulator.toggleWebSocket();
        }

        function simulateRealtimeData() {
            window.dashboardSimulator.simulateRealtimeUpdate();
            window.dashboardSimulator.showNotification('Manual real-time update triggered', 'success');
        }

        // Initialize dashboard when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.dashboardSimulator = new CHAJIPOADashboardSimulator();
        });

        // Add some interactive elements
        document.addEventListener('keydown', (e) => {
            if (e.key === 'r' || e.key === 'R') {
                simulateRealtimeData();
            }
            if (e.key === 'e' || e.key === 'E') {
                exportDashboard('pdf');
            }
            if (e.key === 'w' || e.key === 'W') {
                toggleWebSocket();
            }
        });
    </script>
</body>
</html>